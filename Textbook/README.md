<!--Copyright © Microsoft Corporation. All rights reserved.
  适用于[License](https://github.com/YanjieGao/AI-System/blob/main/LICENSE)版权许可-->

# 人工智能系统 教材

本教材的中文名称设定为 **人工智能系统**，主要讲解支持人工智能的计算机系统设计，对应的中英文课程名称为 **人工智能系统** **System for AI**。本课程中将交替使用一下词汇：**人工智能系统**，**AI-System** 和 **System for AI**。

本教材为[微软人工智能教育与共建社区](https://github.com/microsoft/ai-edu)中规划的人工智能相关教材之一，在[A-基础教程](https://github.com/microsoft/ai-edu/tree/master/A-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B)模块下，课程编号和名称为 *A6-人工智能系统*。

欢迎访问[微软人工智能教育与共建社区](https://github.com/microsoft/ai-edu)的[A-基础教程](https://github.com/microsoft/ai-edu/tree/master/A-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B)模块访问更多相关内容。

- [人工智能系统 教材](#人工智能系统-教材)
  - [写在前面](#写在前面)
  - [如何浏览本系列教程](#如何浏览本系列教程)
  - [人工智能系统教材设立背景](#人工智能系统教材设立背景)
  - [人工智能系统教材设立目的](#人工智能系统教材设立目的)
  - [人工智能系统教材的设计与特点](#人工智能系统教材的设计与特点)
  - [人工智能系统教材目录与大纲](#人工智能系统教材目录与大纲)
  - [附录](#附录)
  - [反馈与贡献](#反馈与贡献)
  - [写在后面](#写在后面)

## 写在前面

如果您觉得教材对您有帮助，请不要忘记给本站加星（点击网页顶部的Star标签），星越多说明本教材越对大家有帮助，我们就越会努力完善本站。

## 如何浏览本系列教程

1. 如果使用浏览器在线观看的话，可以使用 Edge 或 Chrome 浏览器，[加这个Math展示控件](https://chrome.google.com/webstore/detail/mathjax-plugin-for-github/ioemnmodlmafdkllaclgeombjnmnbima)

2. 也可以clone全部内容到本地，然后用VSCode浏览，但VSCode中需要安装能读取Markdown格式的扩展，比如Markdown AllInOne插件。

3. 本教程提供数据包：在"SourceCode"文件夹中下载"DataDownload.py"并运行，输入本地目录后即可开始下载数据包，并自动解压至当地。


## 人工智能系统教材设立背景

近年来人工智能特别是深度学习技术得到了飞速发展，这背后离不开计算机硬件和软件系统的不断进步。在可见的未来，人工智能技术的发展仍将依赖于计算机系统和人工智能相结合的共同创新模式。需要注意的是，计算机系统现在正以更大的规模和更高的复杂性来赋能于人工智能，这背后不仅需要更多的系统上的创新，更需要系统性的思维和方法论。与此同时，人工智能也反过来为设计复杂系统提供支持。

我们注意到，现在的大部分人工智能相关的教材，特别是深度学习和机器学习相关课程主要集中在相关理论、算法或者应用，与系统相关的教材并不多见。我们希望人工智能系统教材能让人工智能相关教育变得更加体系化和普适化，以共同促进人工智能与系统交叉人才的培养。


## 人工智能系统教材设立目的

本课程主要为本科生高年级和研究生设计，帮助学生：

1. 完整的了解支持深度学习的计算机系统架构，并通过实际的问题，来学习深度学习完整生命周期下的系统设计。
 
2. 介绍前沿的系统和人工智能相结合的研究工作，包括AI for Systems and Systems for AI，以帮助高年级的本科生和研究生更好的寻找和定义有意义的研究问题。

3. 从系统研究的角度出发设计实验课程。通过操作和应用主流和最新的框架、平台和工具来鼓励学生动手实现和优化系统模块，以提高解决实际问题的能力，而不仅仅是了解工具使用。

**先修课程:** C/C++/Python, 计算机体系结构，算法导论，操作系统，编译原理，计算机网络

## 人工智能系统教材的设计与特点

教材主要包括以下特点：

1. 体系化: 本书内容设计围绕深度学习系统全栈进行阐述，同时涵盖深度学习系统的设计原则，工作综述和方法学。

2. 深入浅出: 以易于理解的文字和内容呈现方式，简化的实例，抽象出关键系统问题。同时兼顾当前前沿的研究工作，有一定深度。

3. 启发式思考：问题的定义优先于解决方法，阐述本领域的经典问题和代表性方法。启发读者思考，展开新工作。

4. 兼收并蓄：本教材的设计不仅会借助微软和微软亚洲研究院在人工智能和系统交叉领域的研究成果和经验，其中包括微软及研究院开发的一部分平台和工具，也会参考业界主流经典的人工智能系统工作。教材也鼓励其他学校和老师根据自己的需求添加和调整更多的高级内容，或者其他的实验。

## 人工智能系统教材目录与大纲

- [1. 人工智能系统概述](第1章-人工智能系统概述/1-前言.md) 
  - [1.1 深度学习的历史，现状与发展](第1章-人工智能系统概述/1.1-深度学习的历史，现状与发展.md) 	
  - [1.2 算法，框架，体系结构与算力的进步](第1章-人工智能系统概述/1.2-算法，框架，体系结构与算力的进步.md) 	
  - [1.3 深度学习系统组成与生态](第1章-人工智能系统概述/1.3-深度学习系统组成与生态.md) 
- [2. 深度神经网络基础]()
  - 2.1 神经网络模型
    - 2.1.1 张量计算的抽象
    - 2.1.2 模型结构的现状与趋势
  - 2.2 深度学习系统基础
    - 2.2.1 深度学习运算的表示
    - 2.2.2 编译框架与中间表达
    - 2.2.3 运行态和硬件
    - 2.2.4 分布式执行
    - 2.2.5 深度学习系统性能优化
- [3. 深度学习框架基础]()
  - 3.1 深度学习框架的设计权衡
    - 3.1.1 实现神经网络
    - 3.1.2 高级语言实现计算过程
    - 3.1.3 加速设备实现计算过程
    - 3.1.4 早期框架的局限性
  - 3.2 基于数据流图的计算框架
    - 3.2.1 编程模型
    - 3.2.2 反向传播和自动差分
    - 3.3.3 图优化，调度和执行
    - 3.3.4 静态和动态图
    - 3.3.5 符号执行和命令式执行
    - 3.3.6 硬件设备支持
- [4. 矩阵运算与计算机体系结构]()
  - 4.1 深度学习常见模型结构
    - 4.1.1 全连接层映射到矩阵运算
    - 4.1.2 卷积层映射到矩阵运算
    - 4.1.3 循环网络层映射到矩阵运算
    - 4.1.4 注意力层映射到矩阵运算
  - 4.2 计算机体系结构与矩阵运算
    - 4.2.1 CPU体系结构
    - 4.2.2 CPU实现高效计算矩阵乘
  - 4.3 GPU体系结构与矩阵计算
    - 4.3.1 GPU体系结构
    - 4.3.2 GPU编程模型
    - 4.3.3 GPU实现一个简单的计算
  - 4.4	专用芯片与矩阵计算
    - 4.4.1 张量处理单元
    - 4.4.2 低精度量化
    - 4.4.3 复杂指令集
    - 4.4.4 矩阵处理单元
    - 4.4.5 脉动阵列
    - 4.4.6 代表性神经网络芯片
- [5. 深度学习框架的编译与优化]()
  - 5.1 深度神经网络编译器
    - 5.1.1 前端
    - 5.1.2 后端
    - 5.1.3 中间表达
    - 5.1.4 优化过程
  - 5.2 计算图优化
    - 5.2.1 计算图与图优化
    - 5.2.2 算术表达式化简
    - 5.2.3 公共子表达式消除
    - 5.2.4 常数传播
    - 5.2.5 通用矩阵乘自动融合
    - 5.2.6 算子融合
    - 5.2.7 子图替换
    - 5.2.8 随机子图替换
  - 5.3 内存优化
    - 5.3.1 深度学习模型内存分析与预估
    - 5.3.2 基于拓扑序的最小内存分配
    - 5.3.3 根据整数线性规划求解最优内存放置
    - 5.3.4 张量换入换出与张量重计算
  - 5.4 内核优化
    - 5.4.1 算子表达式
    - 5.4.2 算子表示与调度逻辑的分离
    - 5.4.3 自动调度搜索与代码生成
  - 5.5 操作符调度优化
    - 5.5.1	操作符融合
    - 5.5.2	编译时调度
  - 5.6 前沿人工智能编程语言与编译器
    - 5.6.1 语言与编程接口
    - 5.6.2 中间表达
    - 5.6.3 编译器
    - 5.6.4 工具链: 代价模型，类型系统
- [6. 分布式训练算法与系统]()
  - 6.1 分布式计算简介
    - 6.1.1 串行到并行计算
    - 6.1.2 并行计算加速定律
  - 6.2 深度学习并行训练简介
    - 6.2.1 算子内并行
    - 6.2.2 算子间并行
  - 6.3 分布式训练算法分类
    - 6.3.1 数据并行
    - 6.3.2 模型并行
    - 6.3.3 流水并行
  - 6.4 深度学习并行训练同步方式
    - 6.4.1 同步并行
    - 6.4.2 异步并行
    - 6.4.3 半同步并行
  - 6.5 分布式训练系统简介
    - 6.5.1 用户接口
    - 6.5.2 单节点执行单元
    - 6.5.3 通信与协调
  - 6.6 分布式训练框架
    - 6.6.1	框架内嵌分布式训练系统
    - 6.6.2	通用分布式训练系统
    - 6.6.3	特定领域分布式训练系统
- [7. 异构计算集群调度与资源管理系统]()
  - 7.1 异构计算集群管理系统简介
    - 7.1.1 多租环境运行的训练作业
    - 7.1.2 作业生命周期
    - 7.1.3 资源管理系统的设计目标
  - 7.2 训练作业，镜像与容器
    - 7.2.1 深度学习作业依赖与规格
    - 7.2.2 环境依赖：镜像
    - 7.2.3 运行时资源隔离：容器
  - 7.3 调度
    - 7.3.1 调度问题优化目标
    - 7.3.2 群调度
    - 7.3.3 DRF调度 
    - 7.3.4 容量调度
    - 7.3.5 虚拟集群
    - 7.3.6 抢占式调度
  - 7.4 面向深度学习的集群管理系统
    - 7.4.1 深度学习工作负载的需求
    - 7.4.2 异构硬件的多样性
    - 7.4.3 异构硬件下的调度算法设计
    - 7.4.4 代表性异构集群管理系统
- [8. 深度学习推理系统]()
  - 8.1 推理系统简介
    - 8.1.1 对比推理与训练过程
    - 8.1.2 推理系统的优化目标与约束
  - 8.2 推理系统的低延迟优化
    - 8.2.1 层间与张量融合
    - 8.2.2 目标后端自动调优
    - 8.2.3 内存分配策略调优
    - 8.2.4 低精度推理与精度校准
    - 8.2.5 模型压缩
    - 8.2.6 自适应批尺寸
    - 8.2.7 缓存结果
  - 8.3 推理系统的高吞吐优化
    - 8.3.1 加速器并行
    - 8.3.2 动态批尺寸
    - 8.3.3 多模型装箱
    - 8.3.4 多副本部署
  - 8.4 部署
    - 8.4.1 部署扩展性
    - 8.4.2	部署灵活性
    - 8.4.3 模型转换与开放协议
    - 8.4.4 模型版本管理，线上发布，回滚策略
    - 8.4.5 移动端部署
    - 8.4.6 推理芯片
- [9. 自动化机器学习系统]()
  - 9.1 自动化机器学习
    - 9.1.1 超参数搜索
    - 9.1.2 神经网络结构搜索
    - 9.1.3 自动特征工程
  - 9.2 自动化机器学习系统与工具设计
    - 9.2.1 自动化机器学习工具概览
    - 9.2.2 探索式训练过程
    - 9.2.3 自动化机器学习系统编程范式和系统优化前沿
- [10. 强化学习系统]()
  - 10.1 强化学习系统
    - 10.1.1 强化学习基本概念
    - 10.1.2 强化学习和传统机器学习的关系
    - 10.1.3 强化学习与自动机器学习的关系
    - 10.1.4 强化学习流程与模块
    - 10.1.5 大规模强化学习的应用
  - 10.2 强化学习系统
    - 10.2.1 分布式强化学习算法
    - 10.2.2 分布式强化学习对框架的需求和挑战
    - 10.2.3 分布式强化学习框架与应用
- [11. 模型压缩与稀疏化]()
  - 11.1 模型压缩
    - 11.1.1 参数裁剪与共享
    - 11.1.2 低秩分解，知识精炼
    - 11.1.3 自动化模型压缩
  - 11.2 稀疏化
    - 11.2.1 权重稀疏
    - 11.2.2 激活稀疏
    - 11.2.3 梯度稀疏
    - 11.2.4 稀疏与正则化
    - 11.2.5 模型量化
  - 11.3 应用：
    - 11.3.1 预训练模型稀疏化
    - 11.3.2 移动端模型稀疏化
- [12. 安全与隐私]()
  - 12.1 人工智能完整性
    - 12.1.1 预测结果的鲁棒性
    - 12.1.2 预测过程的可信性 
  - 12.2 人工智能保密性
    - 12.2.1 数据保密性 
    - 12.2.2 模型保密性 
  - 12.3 人工智能伦理:
    - 12.3.1 算法的公平性 
    - 12.3.2 算法的滥用
- [13. 人工智能优化计算机系统]()
  - 13.1 人工智能优化系统
    - 13.1.1 简介与趋势
  - 13.2 人工智能优化系统应用
    - 13.2.1 人工智能优化视频流系统
    - 13.2.1 数据库索引优化
    - 13.2.2 系统选项与参数调优
  - 13.3 系统数据，模型，动态性和正确性挑战

## 附录

- [术语表](术语表.md)

## 反馈与贡献

1. 反馈

    如果您对本模块内容有任何反馈，欢迎在 GitHub [Issues](https://github.com/microsoft/AI-System/issues) 模块中留言，我们会积极了解您的反馈，并尽量满足您的要求。

2. 贡献

    如果您想向本模块提供任何有价值的教程内容，请 fork 本仓库到您自己的账号，编辑内容并提交 Pull Request，我们会及时审阅并处理。

    欢迎向本模块贡献有价值的内容。

## 写在后面

加星点赞是一种良好的Open Source的程序员素养，作者的目标是得到10000颗星！星越多，我们的创作团队越努力！
送人玫瑰，手有余香，传播给你的朋友，让大家一起进步！
